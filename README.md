# Инструкции по установке zOS

## Особенности настройки

Установлена возможность подключения всего 7 человек! Требуется дополнительная настройка терминалов в конфигурационном файле `hercules.cnf`.

## Предварительные требования к пользовательским машинам

1. Требуется находится во внутренней сети МГТУ им. Баумана или иметь активное VPN подключение
2. Установить эмулятор терминала 3270
* Linux: пакеты `x3270 x3270-text`, запуск `c3270 <host>:3270`
* Windows: установить программу `x3270`, настроить подключение при запуске основной иконки и согласится на конфигурирование новых иконок

## Последовательность установки и настройки

1. Скачать файлы на сервер
1. Установить эмулятор hercules `sudo dpkg -i hercules_3.13-7_amd64.deb`
1. Распаковать zOS `unzip zOS.113.s.2013.zip`, если требуется, установить пакет `zip`
1. Запустить эмулятор hercules `hercules -f hercules.cnf`
1. Запускаем два экземпляра c3270: первый станет управляющим терминалом IPL, второй - терминалом TSO
1. Нажать в окне hercules **ESC**, затем **L** (переход в режим инциализации IPL) и **A** - выбрать первый загруженный образ диска для загрузки
1. Через некоторое время образ ОС будет загружен и на втором терминале отобразится приветствие
1. Вводим `logon ibmuser`, пароль `ibmuser`
1. Добро пожаловать в сессию TSO!

## Что дальше

### Повторное подключение

Если отключить все терминалы от сессии, то ничего не пропадёт. Первый подключенный терминал станет системным контроллером: на нём отобразится приветсвие эмулятора hercules. Все последующие терминалы будут подключены как устройства пользователей: на них отобразится приветсвие zOS.

Если не выйти из сессии в предыдущем терминале, то после повторного подключения и ввода пароля будет выведено сообщение об ошибке. Достаточно ввести `logoff` чтобы выйти, затем `logon` для повторного входа. Система знает что Вы знаете свой пароль.

### Запуск в фоновом режиме

Для запуска в фоновом режиме воспользуемся программой screen. Это позволит отделить процесс эмулятора hercules от процесса bash, связанного с текущей сессией ssh.

1. Зафиксировать у себя в памяти состояние вывода `pstree`
1. Создадим новую сессию `screen`. Завершить сессию можно при помощи нажатия **SPACE** или **ENTER**
1. После создания сессии, pstree дополнится новым процессом screen, связанным с текущей сессией.
1. Создадим новое окно **CTRL+a** затем **c**. На будущее: просмотр всех окон **CTRL+a** и **w**, а для промотра всех окон с возможность выбор **CTRL+a** и **"** (**SHIFT+'**)
1. В новом окне запустим эмулятор hercules. Теперь от текущей сесси можно спокойно отключатся.
1. После повторного подключения (или во второй сесси ssh) процесс screen будет перенесён отдельно от текущего пользователя и станет новым корневым процессом. Остановки эмулятора hercules не произойдёт.
